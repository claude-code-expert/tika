<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tika - í‹°ì¼“ ìƒì„¸ ëª¨ë‹¬ (SCR-003)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Noto Sans+KR:wght@400;500;700&display=swap" rel="stylesheet" />
  <style>
    /* ===== CSS ë³€ìˆ˜ (ë””ìì¸ í† í°) ===== */
    :root {
      --accent-primary: #629584;
      --accent-hover: #527D6F;
      --accent-light: #E8F5F0;
      --bg-app: #F8F9FB;
      --bg-card: #FFFFFF;
      --text-primary: #2C3E50;
      --text-secondary: #5A6B7F;
      --text-muted: #8993A4;
      --border-light: #DFE1E6;
      --border-medium: #C4C9D1;
      --shadow-dropdown: 0 8px 24px rgba(0,0,0,0.12);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Noto Sans KR', 'Plus Jakarta Sans', sans-serif;
      background: rgba(9, 30, 66, 0.54);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    /* ===== ëª¨ë‹¬ ì• ë‹ˆë©”ì´ì…˜ ===== */
    @keyframes modalIn {
      from { opacity: 0; transform: scale(0.95) translateY(8px); }
      to   { opacity: 1; transform: scale(1)    translateY(0); }
    }

    /* ===== ëª¨ë‹¬ ===== */
    .modal {
      background: var(--bg-card);
      border-radius: 8px;
      box-shadow: var(--shadow-dropdown);
      width: 100%;
      max-width: 720px;
      max-height: 92vh;
      display: flex;
      flex-direction: column;
      animation: modalIn 0.2s ease-out;
      overflow: hidden;
    }

    /* ===== ìƒë‹¨ ì˜ì—­ (detail-top) ===== */
    .detail-top {
      padding: 20px 24px 16px;
      border-bottom: 1px solid var(--border-light);
      flex-shrink: 0;
    }

    /* ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ */
    .detail-top-bar {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
    }

    .modal-close {
      width: 28px;
      height: 28px;
      border: none;
      background: transparent;
      border-radius: 6px;
      cursor: pointer;
      font-size: 18px;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.1s, color 0.1s;
      flex-shrink: 0;
    }

    .modal-close:hover { background: var(--bg-app); color: var(--text-primary); }

    /* ë¼ë²¨ í¸ì§‘ ì˜ì—­ */
    .label-edit-area {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
      position: relative;
      flex: 1;
    }

    .label-item {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 3px 8px 3px 10px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
    }

    .label-remove {
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 12px;
      padding: 0;
      line-height: 1;
      opacity: 0.7;
      transition: opacity 0.1s;
    }

    .label-remove:hover { opacity: 1; }

    .label-add-btn {
      padding: 3px 10px;
      border: 1px dashed var(--border-medium);
      border-radius: 20px;
      font-size: 11px;
      color: var(--text-muted);
      cursor: pointer;
      background: transparent;
      transition: all 0.15s;
      font-family: 'Noto Sans KR', sans-serif;
    }

    .label-add-btn:hover { border-color: var(--accent-primary); color: var(--accent-primary); }

    /* ë¼ë²¨ í”¼ì»¤ ë“œë¡­ë‹¤ìš´ */
    .label-picker {
      display: none;
      position: absolute;
      top: 32px;
      left: 0;
      background: var(--bg-card);
      border: 1px solid var(--border-light);
      border-radius: 8px;
      box-shadow: var(--shadow-dropdown);
      padding: 8px;
      z-index: 200;
      min-width: 200px;
    }

    .label-picker.show { display: block; }

    .label-picker-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: 8px;
      padding: 0 4px;
    }

    .label-picker-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }

    .picker-chip {
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: opacity 0.1s, transform 0.1s;
      font-family: 'Noto Sans KR', sans-serif;
    }

    .picker-chip:hover { transform: scale(1.05); }

    /* ì œëª© */
    .detail-title {
      font-family: 'Plus Jakarta Sans', sans-serif;
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1.4;
      margin-bottom: 10px;
    }

    /* ì¹´í…Œê³ ë¦¬ ë¸Œë ˆë“œí¬ëŸ¼ */
    .breadcrumb-area {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }

    .breadcrumb-item {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 12px;
      color: var(--text-secondary);
    }

    .breadcrumb-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 700;
      color: #fff;
    }

    .breadcrumb-badge.goal    { background: #8B5CF6; }
    .breadcrumb-badge.story   { background: #3B82F6; }
    .breadcrumb-badge.feature { background: #10B981; }
    .breadcrumb-badge.task    { background: #F59E0B; }

    .breadcrumb-sep {
      color: var(--text-muted);
      font-size: 12px;
    }

    .breadcrumb-edit-btn {
      padding: 2px 8px;
      border: 1px solid var(--border-light);
      border-radius: 4px;
      background: transparent;
      font-size: 11px;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.15s;
      font-family: 'Noto Sans KR', sans-serif;
      margin-left: 2px;
    }

    .breadcrumb-edit-btn:hover { border-color: var(--accent-primary); color: var(--accent-primary); }

    /* ì¹´í…Œê³ ë¦¬ ì—ë””í„° */
    .category-editor {
      display: none;
      background: var(--bg-app);
      border: 1px solid var(--border-light);
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 10px;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .category-editor.show { display: flex; }

    .category-editor select {
      padding: 5px 8px;
      border: 1px solid var(--border-light);
      border-radius: 5px;
      font-size: 12px;
      font-family: 'Noto Sans KR', sans-serif;
      background: var(--bg-card);
      outline: none;
      transition: border-color 0.15s;
    }

    .category-editor select:focus { border-color: var(--accent-primary); }

    .category-editor-btns {
      display: flex;
      gap: 6px;
    }

    .btn-xs {
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      font-family: 'Noto Sans KR', sans-serif;
      border: none;
      transition: all 0.15s;
    }

    .btn-xs.save { background: var(--accent-primary); color: #fff; }
    .btn-xs.save:hover { background: var(--accent-hover); }
    .btn-xs.cancel { background: var(--bg-app); border: 1px solid var(--border-light); color: var(--text-secondary); }
    .btn-xs.cancel:hover { border-color: var(--border-medium); }

    /* ë©”íƒ€ í–‰ */
    .meta-row {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .meta-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
    }

    .meta-badge.status-todo    { background: #DBEAFE; color: #1D4ED8; }
    .meta-badge.priority-high  { background: #FFEDD5; color: #C2410C; }
    .meta-badge.due-soon       { background: #FEF9C3; color: #A16207; }

    .meta-assignee {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--text-secondary);
    }

    .mini-avatar {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--accent-primary);
      color: #fff;
      font-size: 10px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }

    /* ===== ë³¸ë¬¸ ===== */
    .detail-body {
      flex: 1;
      overflow-y: auto;
      padding: 0 24px;
      display: flex;
      flex-direction: column;
    }

    /* ì„¹ì…˜ ê³µí†µ */
    .section {
      padding: 16px 0;
      border-bottom: 1px solid var(--border-light);
    }

    .section:last-child { border-bottom: none; }

    .section-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--text-secondary);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* ì„¤ëª… */
    .description-text {
      font-size: 14px;
      color: var(--text-primary);
      line-height: 1.7;
    }

    /* ì²´í¬ë¦¬ìŠ¤íŠ¸ */
    .checklist-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .checklist-progress-text {
      font-size: 12px;
      color: var(--text-muted);
    }

    .progress-bar-wrap {
      height: 4px;
      background: var(--border-light);
      border-radius: 2px;
      margin-bottom: 10px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--accent-primary);
      border-radius: 2px;
      transition: width 0.3s ease;
    }

    .checklist-items { display: flex; flex-direction: column; gap: 6px; }

    .checklist-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 7px 10px;
      border-radius: 6px;
      transition: background 0.1s;
    }

    .checklist-item:hover { background: var(--bg-app); }

    .checklist-item input[type="checkbox"] {
      width: 15px;
      height: 15px;
      accent-color: var(--accent-primary);
      cursor: pointer;
      flex-shrink: 0;
    }

    .checklist-item-text {
      flex: 1;
      font-size: 13px;
      color: var(--text-primary);
      line-height: 1.4;
    }

    .checklist-item-text.done {
      text-decoration: line-through;
      color: var(--text-muted);
    }

    .item-delete-btn {
      width: 22px;
      height: 22px;
      border: none;
      background: transparent;
      border-radius: 4px;
      cursor: pointer;
      color: var(--text-muted);
      font-size: 13px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.1s, background 0.1s, color 0.1s;
    }

    .checklist-item:hover .item-delete-btn { opacity: 1; }
    .item-delete-btn:hover { background: #FEE2E2; color: #DC2626; }

    /* ì²´í¬ë¦¬ìŠ¤íŠ¸ ì…ë ¥ */
    .checklist-add-row {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 8px;
    }

    .checklist-add-input {
      flex: 1;
      padding: 6px 10px;
      border: 1.5px dashed var(--border-medium);
      border-radius: 5px;
      font-size: 13px;
      font-family: 'Noto Sans KR', sans-serif;
      color: var(--text-primary);
      background: var(--bg-card);
      outline: none;
      transition: border-color 0.15s;
    }

    .checklist-add-input:focus { border-color: var(--accent-primary); border-style: solid; }

    .btn-add-check {
      padding: 6px 12px;
      background: var(--bg-app);
      border: 1px solid var(--border-light);
      border-radius: 5px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.15s;
      white-space: nowrap;
      font-family: 'Noto Sans KR', sans-serif;
    }

    .btn-add-check:hover { border-color: var(--accent-primary); color: var(--accent-primary); }

    /* ===== í™œë™ ë‚´ì—­ ===== */
    .activity-list { display: flex; flex-direction: column; gap: 14px; }

    .activity-item {
      display: flex;
      gap: 10px;
      align-items: flex-start;
    }

    .activity-avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--accent-primary);
      color: #fff;
      font-size: 11px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }

    .activity-content { flex: 1; }

    .activity-text {
      font-size: 13px;
      color: var(--text-primary);
      line-height: 1.5;
    }

    .activity-text strong { font-weight: 600; }

    .activity-time {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    /* ëŒ“ê¸€ ë§í’ì„  */
    .comment-bubble {
      background: var(--bg-app);
      border: 1px solid var(--border-light);
      border-radius: 0 6px 6px 6px;
      padding: 8px 12px;
      font-size: 13px;
      color: var(--text-primary);
      line-height: 1.5;
      margin-bottom: 4px;
    }

    /* ëŒ“ê¸€ ì…ë ¥ */
    .comment-input-row {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      padding: 14px 0 6px;
    }

    .comment-textarea {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid var(--border-light);
      border-radius: 6px;
      font-size: 13px;
      font-family: 'Noto Sans KR', sans-serif;
      color: var(--text-primary);
      resize: none;
      min-height: 38px;
      max-height: 100px;
      outline: none;
      transition: border-color 0.15s;
      line-height: 1.5;
    }

    .comment-textarea:focus { border-color: var(--accent-primary); }

    .btn-comment {
      padding: 8px 14px;
      background: var(--accent-primary);
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      font-family: 'Noto Sans KR', sans-serif;
      transition: background 0.15s;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .btn-comment:hover { background: var(--accent-hover); }

    /* ===== í•˜ë‹¨ ì•¡ì…˜ ë°” ===== */
    .detail-footer {
      padding: 12px 24px;
      border-top: 1px solid var(--border-light);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .footer-left, .footer-right {
      display: flex;
      gap: 8px;
    }

    .btn-action {
      padding: 7px 14px;
      border: 1px solid var(--border-light);
      border-radius: 6px;
      background: transparent;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.15s;
      font-family: 'Noto Sans KR', sans-serif;
    }

    .btn-action:hover { border-color: var(--border-medium); color: var(--text-primary); background: var(--bg-app); }

    .btn-action.danger { color: #DC2626; }
    .btn-action.danger:hover { border-color: #DC2626; background: #FEF2F2; }

    /* ìŠ¤í¬ë¡¤ë°” */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 3px; }

    /* ë°°ê²½ ì•ˆë‚´ */
    .bg-hint {
      position: fixed;
      bottom: 20px;
      color: rgba(255,255,255,0.5);
      font-size: 12px;
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- ===== í‹°ì¼“ ìƒì„¸ ëª¨ë‹¬ ===== -->
  <div class="modal" role="dialog" aria-modal="true" aria-label="í‹°ì¼“ ìƒì„¸">

    <!-- ===== ìƒë‹¨ ì˜ì—­ ===== -->
    <div class="detail-top">

      <!-- ë¼ë²¨ í¸ì§‘ + ë‹«ê¸° -->
      <div class="detail-top-bar">

        <!-- ë¼ë²¨ í¸ì§‘ ì˜ì—­ -->
        <div class="label-edit-area" id="labelArea">
          <div class="label-item" style="background:#00c950; color:#fff;" data-label="Backend">
            Backend
            <button class="label-remove" onclick="removeLabel(this)" aria-label="Backend ë¼ë²¨ ì œê±°">âœ•</button>
          </div>
          <div class="label-item" style="background:#615fff; color:#fff;" data-label="Infra">
            Infra
            <button class="label-remove" onclick="removeLabel(this)" aria-label="Infra ë¼ë²¨ ì œê±°">âœ•</button>
          </div>
          <button class="label-add-btn" onclick="toggleLabelPicker()" id="labelAddBtn">+ ë¼ë²¨ ì¶”ê°€</button>

          <!-- ë¼ë²¨ í”¼ì»¤ ë“œë¡­ë‹¤ìš´ -->
          <div class="label-picker" id="labelPicker">
            <div class="label-picker-title">ë¼ë²¨ ì„ íƒ</div>
            <div class="label-picker-chips">
              <button class="picker-chip" style="background:#2b7fff; color:#fff;"    onclick="addLabelFromPicker(this, '#2b7fff', '#fff', 'Frontend')">Frontend</button>
              <button class="picker-chip" style="background:#00c950; color:#fff;"    onclick="addLabelFromPicker(this, '#00c950', '#fff', 'Backend')">Backend</button>
              <button class="picker-chip" style="background:#ad46ff; color:#fff;"    onclick="addLabelFromPicker(this, '#ad46ff', '#fff', 'Design')">Design</button>
              <button class="picker-chip" style="background:#fb2c36; color:#fff;"    onclick="addLabelFromPicker(this, '#fb2c36', '#fff', 'Bug')">Bug</button>
              <button class="picker-chip" style="background:#ffac6d; color:#2C3E50;" onclick="addLabelFromPicker(this, '#ffac6d', '#2C3E50', 'Docs')">Docs</button>
              <button class="picker-chip" style="background:#615fff; color:#fff;"    onclick="addLabelFromPicker(this, '#615fff', '#fff', 'Infra')">Infra</button>
            </div>
          </div>
        </div>

        <button class="modal-close" onclick="handleClose()" aria-label="ë‹«ê¸°">âœ•</button>
      </div>

      <!-- ì œëª© -->
      <h2 class="detail-title">ì‚¬ìš©ì ì¸ì¦ API ì„¤ê³„</h2>

      <!-- ì¹´í…Œê³ ë¦¬ ì—ë””í„° (ìˆ¨ê¹€ ì´ˆê¸° ìƒíƒœ) -->
      <div class="category-editor" id="categoryEditor">
        <select id="editorGoal" onchange="onEditorGoalChange()">
          <option value="g1" selected>MVP ì¶œì‹œ</option>
          <option value="g2">íŒ€ í˜‘ì—… í™•ì¥</option>
        </select>
        <select id="editorStory" onchange="onEditorStoryChange()">
          <option value="s1" selected>ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ</option>
          <option value="s2">ì¹¸ë°˜ ë³´ë“œ í•µì‹¬ ê¸°ëŠ¥</option>
        </select>
        <select id="editorFeature">
          <option value="f1" selected>ì¸ì¦ API</option>
          <option value="f2">DB ì„¤ê³„</option>
        </select>
        <div class="category-editor-btns">
          <button class="btn-xs save" onclick="saveCategory()">ì €ì¥</button>
          <button class="btn-xs cancel" onclick="cancelCategory()">ì·¨ì†Œ</button>
        </div>
      </div>

      <!-- ì¹´í…Œê³ ë¦¬ ë¸Œë ˆë“œí¬ëŸ¼ -->
      <div class="breadcrumb-area" id="breadcrumbArea">
        <div class="breadcrumb-item">
          <span class="breadcrumb-badge goal">G</span>
          MVP ì¶œì‹œ
        </div>
        <span class="breadcrumb-sep">â€º</span>
        <div class="breadcrumb-item">
          <span class="breadcrumb-badge story">S</span>
          ì¸ì¦ ì‹œìŠ¤í…œ
        </div>
        <span class="breadcrumb-sep">â€º</span>
        <div class="breadcrumb-item">
          <span class="breadcrumb-badge feature">F</span>
          ì¸ì¦ API
        </div>
        <span class="breadcrumb-sep">â€º</span>
        <div class="breadcrumb-item">
          <span class="breadcrumb-badge task">T</span>
          JWT êµ¬í˜„
        </div>
        <button class="breadcrumb-edit-btn" onclick="toggleCategoryEditor()" aria-label="ì¹´í…Œê³ ë¦¬ í¸ì§‘">âœ í¸ì§‘</button>
      </div>

      <!-- ë©”íƒ€ ì •ë³´ -->
      <div class="meta-row">
        <span class="meta-badge status-todo">â— TODO</span>
        <span class="meta-badge priority-high">â†‘ HIGH</span>
        <span class="meta-badge due-soon">ğŸ“… 2ì›” 22ì¼</span>
        <div class="meta-assignee">
          <div class="mini-avatar" title="í™ê¸¸ë™">í™</div>
          <span>í™ê¸¸ë™</span>
        </div>
      </div>

    </div>
    <!-- /detail-top -->

    <!-- ===== ë³¸ë¬¸ ===== -->
    <div class="detail-body">

      <!-- ì„¤ëª… ì„¹ì…˜ -->
      <div class="section">
        <div class="section-title">ğŸ“ ì„¤ëª…</div>
        <p class="description-text">
          JWT ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œì˜ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì„¤ê³„í•œë‹¤. Bearer í† í° ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ë©°, í† í° ë§Œë£Œ ë° ê°±ì‹  ì •ì±…ì„ í¬í•¨í•œë‹¤.
        </p>
      </div>

      <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ -->
      <div class="section">
        <div class="checklist-header">
          <div class="section-title" style="margin-bottom:0;">
            â˜‘ ì²´í¬ë¦¬ìŠ¤íŠ¸
            <span class="checklist-progress-text" id="checkProgress">2 / 3</span>
          </div>
        </div>

        <!-- ì§„í–‰ë¥  ë°” -->
        <div class="progress-bar-wrap">
          <div class="progress-bar-fill" id="progressBar" style="width: 66.6%;"></div>
        </div>

        <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© -->
        <div class="checklist-items" id="checklistItems">
          <!-- JSë¡œ ë Œë”ë§ -->
        </div>

        <!-- í•­ëª© ì¶”ê°€ -->
        <div class="checklist-add-row">
          <input
            class="checklist-add-input"
            id="checklistAddInput"
            type="text"
            placeholder="ìƒˆ í•­ëª© ì…ë ¥..."
            onkeydown="handleCheckKey(event)"
          />
          <button class="btn-add-check" onclick="addCheck()">+ ì¶”ê°€</button>
        </div>
      </div>

      <!-- í™œë™ ë‚´ì—­ ì„¹ì…˜ -->
      <div class="section">
        <div class="section-title">ğŸ’¬ í™œë™ ë‚´ì—­</div>

        <div class="activity-list" id="activityList">

          <!-- í™œë™ 1 -->
          <div class="activity-item">
            <div class="activity-avatar" style="background: var(--accent-primary);">í™</div>
            <div class="activity-content">
              <div class="activity-text"><strong>í™ê¸¸ë™</strong> ì¹´ë“œë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤</div>
              <div class="activity-time">2ì›” 19ì¼ 09:30</div>
            </div>
          </div>

          <!-- í™œë™ 2 -->
          <div class="activity-item">
            <div class="activity-avatar" style="background: var(--accent-primary);">í™</div>
            <div class="activity-content">
              <div class="activity-text"><strong>í™ê¸¸ë™</strong> ìƒíƒœë¥¼ <strong>TODO</strong>ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤</div>
              <div class="activity-time">2ì›” 20ì¼ 14:15</div>
            </div>
          </div>

          <!-- ëŒ“ê¸€ -->
          <div class="activity-item">
            <div class="activity-avatar" style="background: var(--accent-primary);">í™</div>
            <div class="activity-content">
              <div class="activity-text"><strong>í™ê¸¸ë™</strong></div>
              <div class="comment-bubble">ë¦¬ë·° ë¶€íƒí•©ë‹ˆë‹¤</div>
              <div class="activity-time">2ì›” 21ì¼ 10:00</div>
            </div>
          </div>

        </div>

        <!-- ëŒ“ê¸€ ì…ë ¥ -->
        <div class="comment-input-row">
          <div class="mini-avatar" style="margin-top:4px;" title="í™ê¸¸ë™">í™</div>
          <textarea
            class="comment-textarea"
            id="commentInput"
            placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..."
            rows="1"
          ></textarea>
          <button class="btn-comment" onclick="submitComment()">ëŒ“ê¸€ ì‘ì„±</button>
        </div>

      </div>
      <!-- /í™œë™ ë‚´ì—­ -->

    </div>
    <!-- /detail-body -->

    <!-- ===== í•˜ë‹¨ ì•¡ì…˜ ë°” ===== -->
    <div class="detail-footer">
      <div class="footer-left">
        <button class="btn-action" onclick="alert('í¸ì§‘ ëª¨ë“œ ì—´ë¦¼')">âœ í¸ì§‘</button>
        <button class="btn-action" onclick="alert('í‹°ì¼“ì´ ë³µì œë˜ì—ˆìŠµë‹ˆë‹¤.')">ğŸ“‹ ë³µì œ</button>
        <button class="btn-action" onclick="alert('ì´ë™ ë‹¤ì´ì–¼ë¡œê·¸ ì—´ë¦¼')">â†” ì´ë™</button>
      </div>
      <div class="footer-right">
        <button class="btn-action danger" onclick="handleDelete()">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>

  </div>

  <p class="bg-hint">ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸° | board.htmlì—ì„œ ì‹¤ì œ ë³´ë“œ í™•ì¸</p>

  <script>
    /* ===== ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„° ===== */
    let checkItems = [
      { id: 1, text: 'JWT í† í° ìƒì„±/ê²€ì¦ ë¡œì§ êµ¬í˜„', done: true },
      { id: 2, text: 'API ì—”ë“œí¬ì¸íŠ¸ ëª…ì„¸ ì‘ì„±',     done: false },
      { id: 3, text: 'ë¯¸ë“¤ì›¨ì–´ ì²´ì¸ ì„¤ê³„',            done: true },
    ];

    let nextCheckId = 4;

    /* ===== ì²´í¬ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ===== */
    function renderChecklist() {
      const container = document.getElementById('checklistItems');
      container.innerHTML = '';

      checkItems.forEach(item => {
        const div = document.createElement('div');
        div.className = 'checklist-item';
        div.dataset.id = item.id;
        div.innerHTML = `
          <input
            type="checkbox"
            ${item.done ? 'checked' : ''}
            onchange="toggleCheckItem(${item.id})"
            aria-label="${item.text}"
          />
          <span class="checklist-item-text ${item.done ? 'done' : ''}">${item.text}</span>
          <button class="item-delete-btn" onclick="deleteCheckItem(${item.id})" aria-label="í•­ëª© ì‚­ì œ">âœ•</button>
        `;
        container.appendChild(div);
      });

      updateProgress();
    }

    function updateProgress() {
      const total = checkItems.length;
      const done  = checkItems.filter(i => i.done).length;
      const pct   = total > 0 ? (done / total) * 100 : 0;

      document.getElementById('checkProgress').textContent = `${done} / ${total}`;
      document.getElementById('progressBar').style.width = pct + '%';
    }

    function toggleCheckItem(id) {
      const item = checkItems.find(i => i.id === id);
      if (item) item.done = !item.done;
      renderChecklist();
    }

    function deleteCheckItem(id) {
      checkItems = checkItems.filter(i => i.id !== id);
      renderChecklist();
    }

    function addCheck() {
      const input = document.getElementById('checklistAddInput');
      const text = input.value.trim();
      if (!text) return;
      checkItems.push({ id: nextCheckId++, text, done: false });
      input.value = '';
      renderChecklist();
    }

    function handleCheckKey(e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        addCheck();
      }
    }

    /* ===== ë¼ë²¨ ê´€ë ¨ ===== */
    function removeLabel(btn) {
      const labelItem = btn.closest('.label-item');
      labelItem.remove();
    }

    function toggleLabelPicker() {
      const picker = document.getElementById('labelPicker');
      picker.classList.toggle('show');
    }

    function addLabelFromPicker(btn, bg, textColor, name) {
      // ì´ë¯¸ ìˆëŠ” ë¼ë²¨ì¸ì§€ í™•ì¸
      const existing = document.querySelector(`.label-item[data-label="${name}"]`);
      if (existing) {
        document.getElementById('labelPicker').classList.remove('show');
        return;
      }

      // ë¼ë²¨ ì¶”ê°€
      const div = document.createElement('div');
      div.className = 'label-item';
      div.style.background = bg;
      div.style.color = textColor;
      div.dataset.label = name;
      div.innerHTML = `
        ${name}
        <button class="label-remove" onclick="removeLabel(this)" aria-label="${name} ë¼ë²¨ ì œê±°">âœ•</button>
      `;

      const area = document.getElementById('labelArea');
      const addBtn = document.getElementById('labelAddBtn');
      const picker = document.getElementById('labelPicker');
      area.insertBefore(div, addBtn);
      picker.classList.remove('show');
    }

    /* ë¼ë²¨ í”¼ì»¤ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸° */
    document.addEventListener('click', function(e) {
      const picker = document.getElementById('labelPicker');
      if (!e.target.closest('#labelPicker') && !e.target.closest('#labelAddBtn')) {
        picker.classList.remove('show');
      }
    });

    /* ===== ì¹´í…Œê³ ë¦¬ ë¸Œë ˆë“œí¬ëŸ¼ í¸ì§‘ ===== */
    function toggleCategoryEditor() {
      const editor = document.getElementById('categoryEditor');
      const isShow = editor.classList.contains('show');

      if (isShow) {
        cancelCategory();
      } else {
        editor.classList.add('show');
      }
    }

    function saveCategory() {
      const goalSel    = document.getElementById('editorGoal');
      const storySel   = document.getElementById('editorStory');
      const featureSel = document.getElementById('editorFeature');

      alert(
        'ì¹´í…Œê³ ë¦¬ ì €ì¥!\n\n' +
        'Goal: '    + goalSel.options[goalSel.selectedIndex].text + '\n' +
        'Story: '   + storySel.options[storySel.selectedIndex].text + '\n' +
        'Feature: ' + featureSel.options[featureSel.selectedIndex].text
      );

      document.getElementById('categoryEditor').classList.remove('show');
    }

    function cancelCategory() {
      document.getElementById('categoryEditor').classList.remove('show');
    }

    /* ìºìŠ¤ì¼€ì´ë”© - Story */
    function onEditorGoalChange() {
      // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” Goalì— ë”°ë¼ Story ì˜µì…˜ ê°±ì‹ 
      const storySel = document.getElementById('editorStory');
      storySel.innerHTML = '<option value="">Story ì„ íƒ</option>';
    }

    /* ìºìŠ¤ì¼€ì´ë”© - Feature */
    function onEditorStoryChange() {
      const featureSel = document.getElementById('editorFeature');
      featureSel.innerHTML = '<option value="">Feature ì„ íƒ</option>';
    }

    /* ===== ëŒ“ê¸€ ì‘ì„± ===== */
    function submitComment() {
      const textarea = document.getElementById('commentInput');
      const text = textarea.value.trim();

      if (!text) {
        textarea.style.borderColor = '#DC2626';
        return;
      }

      textarea.style.borderColor = '';

      // í˜„ì¬ ì‹œê°„ í¬ë§·
      const now = new Date();
      const timeStr = `${now.getMonth() + 1}ì›” ${now.getDate()}ì¼ ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;

      // í™œë™ ë‚´ì—­ì— ì¶”ê°€
      const activityList = document.getElementById('activityList');

      const item = document.createElement('div');
      item.className = 'activity-item';
      item.innerHTML = `
        <div class="activity-avatar" style="background: var(--accent-primary);">í™</div>
        <div class="activity-content">
          <div class="activity-text"><strong>í™ê¸¸ë™</strong></div>
          <div class="comment-bubble">${text}</div>
          <div class="activity-time">${timeStr}</div>
        </div>
      `;

      activityList.appendChild(item);
      textarea.value = '';
      item.scrollIntoView({ behavior: 'smooth' });
    }

    /* ===== ì‚­ì œ ===== */
    function handleDelete() {
      if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
        alert('ì‚­ì œë¨');
      }
    }

    /* ===== ë‹«ê¸° ===== */
    function handleClose() {
      alert('ëª¨ë‹¬ ë‹«í˜');
    }

    /* ESC í‚¤ */
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') handleClose();
    });

    /* ===== ì´ˆê¸° ë Œë”ë§ ===== */
    renderChecklist();
  </script>

</body>
</html>
