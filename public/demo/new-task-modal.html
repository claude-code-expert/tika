<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCR-002 â€” ìƒˆ ì—…ë¬´ ìƒì„± ëª¨ë‹¬ | Tika</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --font-display: 'Plus Jakarta Sans', 'Noto Sans KR', sans-serif;
      --font-body: 'Noto Sans KR', 'Plus Jakarta Sans', sans-serif;
      --text-h1: 20px; --text-h2: 16px; --text-body1: 14px; --text-body2: 12px; --text-small: 11px;
      --fw-bold: 700; --fw-semibold: 600; --fw-medium: 500; --fw-regular: 400;
      --bg-app: #F8F9FB; --bg-header: #FFFFFF; --bg-sidebar: #F1F3F6;
      --bg-card: #FFFFFF; --bg-column: #F4F5F7;
      --text-primary: #2C3E50; --text-secondary: #5A6B7F; --text-muted: #8993A4;
      --accent-primary: #629584; --accent-primary-hover: #527D6F; --accent-light: #E8F5F0;
      --border-light: #DFE1E6; --border-medium: #C4C9D1;
      --radius-card: 8px; --radius-column: 12px; --radius-button: 6px; --radius-tag: 4px;
      --shadow-dropdown: 0 8px 24px rgba(0,0,0,0.12);
      --sp-xs: 4px; --sp-sm: 8px; --sp-md: 12px; --sp-lg: 16px; --sp-xl: 24px;
    }
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; font-family: var(--font-body); font-size: var(--text-body1); color: var(--text-primary); background: var(--bg-app); -webkit-font-smoothing: antialiased; }
    .ic { display: inline-flex; align-items: center; justify-content: center; flex-shrink: 0; vertical-align: middle; }
    .ic svg { width: 100%; height: 100%; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; fill: none; }

    /* Page demo wrapper */
    .demo-page { display: flex; align-items: flex-start; justify-content: center; min-height: 100vh; padding: 40px 16px; }

    /* Modal Overlay (shown directly for demo) */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(9,30,66,0.54);
      z-index: 300; display: flex; align-items: flex-start; justify-content: center;
      padding: 40px 16px; overflow-y: auto;
    }
    .modal {
      background: #fff; border-radius: var(--radius-column); box-shadow: 0 16px 48px rgba(0,0,0,0.2);
      width: 100%; position: relative; animation: modalIn 0.2s ease;
    }
    @keyframes modalIn { from { opacity: 0; transform: translateY(-12px); } to { opacity: 1; transform: translateY(0); } }
    .modal-close {
      position: absolute; top: 16px; right: 16px; width: 32px; height: 32px;
      display: flex; align-items: center; justify-content: center;
      border: none; background: transparent; border-radius: var(--radius-button);
      color: var(--text-muted); cursor: pointer; transition: all 0.15s; z-index: 1;
    }
    .modal-close:hover { background: var(--bg-sidebar); color: var(--text-primary); }
    .modal-new { max-width: 560px; }
    .modal-header { padding: 20px 24px 16px; border-bottom: 1px solid var(--border-light); }
    .modal-header h2 { font-family: var(--font-display); font-size: 18px; font-weight: var(--fw-semibold); }
    .modal-body { padding: 20px 24px; max-height: 70vh; overflow-y: auto; }
    .modal-body::-webkit-scrollbar { width: 4px; }
    .modal-body::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 2px; }
    .form-group { margin-bottom: 16px; }
    .form-group:last-child { margin-bottom: 0; }
    .form-label { display: block; font-size: var(--text-body2); font-weight: var(--fw-medium); color: var(--text-secondary); margin-bottom: 6px; }
    .form-label .req { color: #EF4444; margin-left: 2px; }
    .form-input, .form-textarea, .form-select {
      width: 100%; padding: 8px 12px; border: 1px solid var(--border-light);
      border-radius: var(--radius-button); font-family: var(--font-body);
      font-size: var(--text-body1); color: var(--text-primary); outline: none;
      transition: border-color 0.15s, box-shadow 0.15s; background: #fff;
    }
    .form-textarea { resize: vertical; min-height: 80px; }
    .form-input:focus, .form-textarea:focus, .form-select:focus { border-color: var(--accent-primary); box-shadow: 0 0 0 3px var(--accent-light); }
    .form-input::placeholder, .form-textarea::placeholder { color: var(--text-muted); }
    .form-input.error, .form-select.error { border-color: #EF4444; }
    .form-error { font-size: var(--text-small); color: #EF4444; margin-top: 4px; display: none; }
    .form-error.show { display: block; }
    .form-row { display: flex; gap: 12px; }
    .form-row .form-group { flex: 1; }
    .modal-footer { padding: 16px 24px; border-top: 1px solid var(--border-light); display: flex; justify-content: flex-end; gap: 8px; }
    .btn-cancel {
      height: 36px; padding: 0 16px; border: 1px solid var(--border-light);
      border-radius: var(--radius-button); background: #fff; font-family: var(--font-body);
      font-size: var(--text-body2); font-weight: var(--fw-medium); color: var(--text-secondary);
      cursor: pointer; transition: all 0.15s;
    }
    .btn-cancel:hover { background: var(--bg-sidebar); }
    .btn-submit {
      height: 36px; padding: 0 20px; border: none; border-radius: var(--radius-button);
      background: var(--accent-primary); color: #fff; font-family: var(--font-body);
      font-size: var(--text-body2); font-weight: var(--fw-semibold); cursor: pointer; transition: background 0.15s;
    }
    .btn-submit:hover { background: var(--accent-primary-hover); }

    /* â•â• Type Selector â•â• */
    .type-selector { display: flex; gap: 8px; flex-wrap: wrap; }
    .type-selector .type-btn {
      flex: 1; min-width: 100px; height: 42px; display: flex; align-items: center; justify-content: center; gap: 6px;
      border: 2px solid var(--border-light); border-radius: var(--radius-card);
      background: #fff; font-family: var(--font-body); font-size: var(--text-body2);
      font-weight: var(--fw-semibold); cursor: pointer; transition: all 0.15s; color: var(--text-secondary);
    }
    .type-btn:hover { border-color: var(--border-medium); background: var(--bg-sidebar); }
    .type-btn .type-dot { width: 10px; height: 10px; border-radius: 50%; }
    .type-btn[data-type="GOAL"] .type-dot { background: #8B5CF6; }
    .type-btn[data-type="STORY"] .type-dot { background: #3B82F6; }
    .type-btn[data-type="FEATURE"] .type-dot { background: #10B981; }
    .type-btn[data-type="TASK"] .type-dot { background: #F59E0B; }
    .type-btn.selected[data-type="GOAL"] { border-color: #8B5CF6; background: #F5F3FF; color: #7C3AED; }
    .type-btn.selected[data-type="STORY"] { border-color: #3B82F6; background: #EFF6FF; color: #2563EB; }
    .type-btn.selected[data-type="FEATURE"] { border-color: #10B981; background: #ECFDF5; color: #059669; }
    .type-btn.selected[data-type="TASK"] { border-color: #F59E0B; background: #FFFBEB; color: #D97706; }
    .type-selector.error .type-btn { border-color: #FCA5A5; }

    /* â•â• Tag Chips â•â• */
    .form-tags-input { display: flex; flex-wrap: wrap; gap: 6px; align-items: center; }
    .form-tag-chip {
      display: inline-flex; align-items: center; gap: 4px; height: 26px; padding: 0 10px;
      border-radius: 13px; font-size: 11px; font-weight: var(--fw-medium);
      cursor: pointer; border: 2px solid transparent; color: #fff;
      transition: all 0.15s; opacity: 0.45;
    }
    .form-tag-chip:hover { opacity: 0.75; }
    .form-tag-chip.selected { opacity: 1; border-color: var(--text-primary); }

    /* â•â• Custom Tag Creator â•â• */
    .tag-creator { display: flex; align-items: center; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
    .tag-creator-input {
      flex: 0 0 auto; width: 120px; height: 28px; padding: 0 8px; border: 1px solid var(--border-light);
      border-radius: var(--radius-tag); font-family: var(--font-body); font-size: 12px; outline: none;
    }
    .tag-creator-input:focus { border-color: var(--accent-primary); box-shadow: 0 0 0 2px var(--accent-light); }
    .tag-creator-input::placeholder { color: var(--text-muted); }
    .tag-color-swatches { display: flex; gap: 3px; flex-wrap: wrap; }
    .tag-swatch {
      width: 18px; height: 18px; border-radius: 50%; border: 2px solid transparent;
      cursor: pointer; transition: border-color 0.15s, transform 0.1s;
    }
    .tag-swatch:hover { transform: scale(1.15); }
    .tag-swatch.sel { border-color: var(--text-primary); }
    .tag-creator-btn {
      height: 28px; padding: 0 10px; border: none; border-radius: var(--radius-tag);
      background: var(--accent-primary); color: #fff; font-size: 11px; font-weight: var(--fw-medium);
      cursor: pointer; white-space: nowrap; transition: background 0.15s;
    }
    .tag-creator-btn:hover { background: var(--accent-primary-hover); }

    /* â•â• Checklist Builder â•â• */
    .cl-builder { display: flex; flex-direction: column; gap: 4px; }
    .cl-builder-items { display: flex; flex-direction: column; gap: 2px; }
    .cl-builder-item {
      display: flex; align-items: center; gap: 8px; padding: 6px 8px;
      background: #fff; border: 1px solid var(--border-light); border-radius: var(--radius-button);
    }
    .cl-builder-item input[type="checkbox"] { width: 15px; height: 15px; accent-color: var(--accent-primary); cursor: pointer; flex-shrink: 0; }
    .cl-builder-item span { flex: 1; font-size: 13px; color: var(--text-primary); }
    .cl-builder-item .cl-rm {
      width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;
      border: none; background: transparent; color: var(--text-muted); cursor: pointer;
      border-radius: 50%; font-size: 14px; transition: all 0.15s; flex-shrink: 0;
    }
    .cl-builder-item .cl-rm:hover { background: #FEE2E2; color: #DC2626; }
    .cl-builder-add { display: flex; align-items: center; gap: 6px; margin-top: 4px; }
    .cl-builder-input {
      flex: 1; height: 32px; padding: 0 10px; border: 1px dashed var(--border-medium);
      border-radius: var(--radius-button); font-family: var(--font-body); font-size: 13px;
      outline: none; background: transparent; color: var(--text-primary);
    }
    .cl-builder-input:focus { border-style: solid; border-color: var(--accent-primary); background: #fff; box-shadow: 0 0 0 2px var(--accent-light); }
    .cl-builder-input::placeholder { color: var(--text-muted); }

    /* â•â• Cascading Category â•â• */
    .cat-select-row { display: flex; gap: 8px; flex-wrap: wrap; }
    .cat-select-row .form-group { flex: 1; min-width: 120px; margin-bottom: 0; }
    .cat-select-row .form-select { font-size: 12px; padding: 6px 8px; }
    .form-select:disabled { opacity: 0.5; cursor: not-allowed; background: var(--bg-sidebar); }
    .cat-note { font-size: var(--text-small); color: var(--text-muted); margin-top: 6px; font-style: italic; }

    /* Demo info */
    .demo-info { position: fixed; bottom: 16px; left: 50%; transform: translateX(-50%); background: var(--text-primary); color: #fff; font-size: var(--text-small); padding: 6px 16px; border-radius: 20px; z-index: 999; opacity: 0.8; }
  </style>
</head>
<body>
<div class="demo-info">SCR-002 Â· ìƒˆ ì—…ë¬´ ìƒì„± ëª¨ë‹¬ ë°ëª¨ â€” íƒ€ì… ì„ íƒ, í¼ ê²€ì¦, ì²´í¬ë¦¬ìŠ¤íŠ¸, ë¼ë²¨, ìºìŠ¤ì¼€ì´ë”© ì¹´í…Œê³ ë¦¬</div>

<div class="modal-overlay" style="display:flex">
  <div class="modal modal-new">
    <button class="modal-close" onclick="alert('ëª¨ë‹¬ ë‹«ê¸°')">
      <span class="ic" style="width:18px;height:18px"><svg viewBox="0 0 24 24"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></span>
    </button>
    <div class="modal-header"><h2>ìƒˆ ì—…ë¬´ ë§Œë“¤ê¸°</h2></div>
    <div class="modal-body">

      <!-- 1. íƒ€ì… ì„ íƒ (í•„ìˆ˜) -->
      <div class="form-group">
        <label class="form-label">íƒ€ì… <span class="req">*</span></label>
        <div class="type-selector" id="typeSelector">
          <button class="type-btn" data-type="GOAL" onclick="selectType(this)"><span class="type-dot"></span>Goal</button>
          <button class="type-btn" data-type="STORY" onclick="selectType(this)"><span class="type-dot"></span>Story</button>
          <button class="type-btn" data-type="FEATURE" onclick="selectType(this)"><span class="type-dot"></span>Feature</button>
          <button class="type-btn" data-type="TASK" onclick="selectType(this)"><span class="type-dot"></span>Task</button>
        </div>
        <div class="form-error" id="typeError">íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”</div>
      </div>

      <!-- 2. ì œëª© (í•„ìˆ˜) -->
      <div class="form-group">
        <label class="form-label">ì œëª© <span class="req">*</span></label>
        <input class="form-input" type="text" placeholder="ì—…ë¬´ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" id="newTitle" maxlength="200" />
        <div class="form-error" id="titleError">ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš” (1~200ì)</div>
      </div>

      <!-- 3. ì„¤ëª… -->
      <div class="form-group">
        <label class="form-label">ì„¤ëª…</label>
        <textarea class="form-textarea" placeholder="ì—…ë¬´ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª…ì„ ì‘ì„±í•˜ì„¸ìš”..." maxlength="1000"></textarea>
      </div>

      <!-- 4. ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¹Œë” -->
      <div class="form-group">
        <label class="form-label">ì²´í¬ë¦¬ìŠ¤íŠ¸</label>
        <div class="cl-builder">
          <div class="cl-builder-items" id="clItems">
            <div class="cl-builder-item">
              <input type="checkbox" />
              <span>JWT í† í° ìƒì„±/ê²€ì¦ ë¡œì§ êµ¬í˜„</span>
              <button class="cl-rm" onclick="this.parentElement.remove()">Ã—</button>
            </div>
            <div class="cl-builder-item">
              <input type="checkbox" checked />
              <span>API ì—”ë“œí¬ì¸íŠ¸ ëª…ì„¸ ì‘ì„±</span>
              <button class="cl-rm" onclick="this.parentElement.remove()">Ã—</button>
            </div>
          </div>
          <div class="cl-builder-add">
            <input class="cl-builder-input" type="text" placeholder="í•­ëª© ì¶”ê°€..." id="clInput" maxlength="200" />
            <button class="tag-creator-btn" style="height:32px" onclick="addClItem()">ì¶”ê°€</button>
          </div>
        </div>
      </div>

      <!-- 5. ë¼ë²¨ -->
      <div class="form-group">
        <label class="form-label">ë¼ë²¨</label>
        <div class="form-tags-input" id="tagChips">
          <span class="form-tag-chip" data-tag="Frontend" style="background:#2b7fff" onclick="toggleChip(this)">Frontend</span>
          <span class="form-tag-chip" data-tag="Backend" style="background:#00c950" onclick="toggleChip(this)">Backend</span>
          <span class="form-tag-chip" data-tag="Design" style="background:#ad46ff" onclick="toggleChip(this)">Design</span>
          <span class="form-tag-chip" data-tag="Bug" style="background:#fb2c36" onclick="toggleChip(this)">Bug</span>
          <span class="form-tag-chip" data-tag="Docs" style="background:#ffac6d;color:#3D2200" onclick="toggleChip(this)">Docs</span>
          <span class="form-tag-chip" data-tag="Infra" style="background:#615fff" onclick="toggleChip(this)">Infra</span>
        </div>
        <div class="tag-creator">
          <input class="tag-creator-input" type="text" placeholder="ë¼ë²¨ëª…" maxlength="20" id="tagNameInput" />
          <div class="tag-color-swatches" id="swatches"></div>
          <button class="tag-creator-btn" onclick="addCustomTag()">ì¶”ê°€</button>
        </div>
      </div>

      <!-- 6. ìƒìœ„ ì¹´í…Œê³ ë¦¬ (ìºìŠ¤ì¼€ì´ë”©) -->
      <div class="form-group" id="catGroup">
        <label class="form-label">ìƒìœ„ ì¹´í…Œê³ ë¦¬</label>
        <div class="cat-select-row" id="catRow">
          <!-- Dynamically populated based on type selection -->
        </div>
        <div class="cat-note" id="catNote">íƒ€ì…ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</div>
      </div>

      <!-- 7. ìƒíƒœ / ìš°ì„ ìˆœìœ„ -->
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">ìƒíƒœ <span class="req">*</span></label>
          <select class="form-select" id="newStatus">
            <option value="BACKLOG">Backlog</option>
            <option value="TODO" selected>TODO</option>
            <option value="IN_PROGRESS">In Progress</option>
            <option value="DONE">Done</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">ìš°ì„ ìˆœìœ„</label>
          <select class="form-select">
            <option value="">ì„ íƒ ì•ˆ í•¨</option>
            <option value="CRITICAL">ğŸ”´ ê¸´ê¸‰</option>
            <option value="HIGH">ğŸŸ  ë†’ìŒ</option>
            <option value="MEDIUM" selected>ğŸŸ¡ ì¤‘ê°„</option>
            <option value="LOW">âšª ë‚®ìŒ</option>
          </select>
        </div>
      </div>

      <!-- 8. ë§ˆê°ì¼ / ë‹´ë‹¹ì -->
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">ë§ˆê°ì¼</label>
          <input class="form-input" type="date" />
        </div>
        <div class="form-group">
          <label class="form-label">ë‹´ë‹¹ì</label>
          <select class="form-select">
            <option value="">ë¯¸ë°°ì •</option>
            <option value="1">í™ê¸¸ë™</option>
            <option value="2">ê¹€ë¯¼ìˆ˜</option>
            <option value="3">ì´ì„œì—°</option>
          </select>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-cancel" onclick="alert('ì·¨ì†Œ')">ì·¨ì†Œ</button>
      <button class="btn-submit" onclick="submitForm()">ì—…ë¬´ ìƒì„±</button>
    </div>
  </div>
</div>

<script>
// â”€â”€ Hierarchy Data â”€â”€
const hierarchy = {
  goals: [{ id:'G1', name:'MVP ì¶œì‹œ' }, { id:'G2', name:'íŒ€ í˜‘ì—… í™•ì¥' }],
  stories: [
    { id:'S1', goalId:'G1', name:'ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ' },
    { id:'S2', goalId:'G1', name:'ì¹¸ë°˜ ë³´ë“œ í•µì‹¬ ê¸°ëŠ¥' },
    { id:'S3', goalId:'G2', name:'í”„ë¡œì íŠ¸ ê´€ë¦¬ ê¸°ë°˜' }
  ],
  features: [
    { id:'F1', storyId:'S1', name:'ì¸ì¦ API' },
    { id:'F2', storyId:'S1', name:'ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„' },
    { id:'F3', storyId:'S2', name:'ë³´ë“œ UI' },
    { id:'F4', storyId:'S2', name:'ë“œë˜ê·¸ì•¤ë“œë¡­' },
    { id:'F5', storyId:'S3', name:'ë¬¸ì„œí™”' }
  ]
};

let selectedType = null;

// â”€â”€ Type Selector â”€â”€
function selectType(btn) {
  document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  selectedType = btn.dataset.type;
  document.getElementById('typeSelector').classList.remove('error');
  document.getElementById('typeError').classList.remove('show');
  updateCategoryDropdowns();
}

// â”€â”€ Category Cascading â”€â”€
function updateCategoryDropdowns() {
  const row = document.getElementById('catRow');
  const note = document.getElementById('catNote');
  row.innerHTML = '';

  if (!selectedType || selectedType === 'GOAL') {
    note.textContent = selectedType === 'GOAL' ? 'Goalì€ ìµœìƒìœ„ íƒ€ì…ì´ë¯€ë¡œ ìƒìœ„ ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤' : 'íƒ€ì…ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”';
    note.style.display = 'block';
    return;
  }
  note.style.display = 'none';

  // Goal dropdown (always shown for Story/Feature/Task)
  const goalGroup = makeSelect('Goal ì„ íƒ', hierarchy.goals, 'catGoal');
  row.appendChild(goalGroup);

  if (selectedType === 'FEATURE' || selectedType === 'TASK') {
    const storyGroup = makeSelect('Story ì„ íƒ', [], 'catStory');
    storyGroup.querySelector('select').disabled = true;
    row.appendChild(storyGroup);
  }
  if (selectedType === 'TASK') {
    const featureGroup = makeSelect('Feature ì„ íƒ', [], 'catFeature');
    featureGroup.querySelector('select').disabled = true;
    row.appendChild(featureGroup);
  }

  document.getElementById('catGoal').addEventListener('change', function() {
    const goalId = this.value;
    if (selectedType === 'FEATURE' || selectedType === 'TASK') {
      const storySel = document.getElementById('catStory');
      const stories = hierarchy.stories.filter(s => s.goalId === goalId);
      populateSelect(storySel, stories);
      storySel.disabled = !goalId;
      if (document.getElementById('catFeature')) {
        document.getElementById('catFeature').innerHTML = '<option value="">Feature ì„ íƒ</option>';
        document.getElementById('catFeature').disabled = true;
      }
    }
  });

  if (document.getElementById('catStory')) {
    document.getElementById('catStory').addEventListener('change', function() {
      if (selectedType === 'TASK') {
        const featureSel = document.getElementById('catFeature');
        const features = hierarchy.features.filter(f => f.storyId === this.value);
        populateSelect(featureSel, features);
        featureSel.disabled = !this.value;
      }
    });
  }
}

function makeSelect(placeholder, items, id) {
  const group = document.createElement('div');
  group.className = 'form-group';
  group.style.marginBottom = '0';
  group.style.flex = '1';
  group.style.minWidth = '120px';
  const sel = document.createElement('select');
  sel.className = 'form-select';
  sel.id = id;
  sel.style.fontSize = '12px';
  sel.style.padding = '6px 8px';
  sel.innerHTML = `<option value="">${placeholder}</option>` + items.map(i => `<option value="${i.id}">${i.name}</option>`).join('');
  group.appendChild(sel);
  return group;
}

function populateSelect(sel, items) {
  const placeholder = sel.options[0].text;
  sel.innerHTML = `<option value="">${placeholder}</option>` + items.map(i => `<option value="${i.id}">${i.name}</option>`).join('');
}

// â”€â”€ Tag Chips â”€â”€
function toggleChip(el) {
  const selected = document.querySelectorAll('.form-tag-chip.selected').length;
  if (!el.classList.contains('selected') && selected >= 3) { alert('ìµœëŒ€ 3ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤'); return; }
  el.classList.toggle('selected');
}

// â”€â”€ Swatch Palette â”€â”€
const palette = ['#fb2c36','#615fff','#00c950','#2b7fff','#ad46ff','#ff29d3','#a0628c','#89d0f0','#71e4bf','#46e264','#caee68','#fffe92','#ffac6d','#f7d1d1','#f7a2ff','#c1d1ff','#c5dbdc'];
let selectedColor = palette[0];
const swatchContainer = document.getElementById('swatches');
palette.forEach((c, i) => {
  const s = document.createElement('span');
  s.className = 'tag-swatch' + (i === 0 ? ' sel' : '');
  s.style.background = c;
  s.onclick = () => { document.querySelectorAll('.tag-swatch').forEach(x => x.classList.remove('sel')); s.classList.add('sel'); selectedColor = c; };
  swatchContainer.appendChild(s);
});

function addCustomTag() {
  const input = document.getElementById('tagNameInput');
  const name = input.value.trim();
  if (!name) return;
  const lum = hexLuminance(selectedColor);
  const textCol = lum > 160 ? '#333' : '#fff';
  const chip = document.createElement('span');
  chip.className = 'form-tag-chip selected';
  chip.style.background = selectedColor;
  chip.style.color = textCol;
  chip.textContent = name;
  chip.dataset.tag = name;
  chip.onclick = function() { toggleChip(this); };
  document.getElementById('tagChips').appendChild(chip);
  input.value = '';
}

function hexLuminance(hex) {
  const r = parseInt(hex.slice(1,3),16), g = parseInt(hex.slice(3,5),16), b = parseInt(hex.slice(5,7),16);
  return 0.299*r + 0.587*g + 0.114*b;
}

// â”€â”€ Checklist â”€â”€
function addClItem() {
  const input = document.getElementById('clInput');
  const text = input.value.trim();
  if (!text) return;
  const items = document.getElementById('clItems');
  if (items.children.length >= 20) { alert('ìµœëŒ€ 20ê°œê¹Œì§€ ì¶”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤'); return; }
  const item = document.createElement('div');
  item.className = 'cl-builder-item';
  item.innerHTML = `<input type="checkbox" /><span>${text}</span><button class="cl-rm" onclick="this.parentElement.remove()">Ã—</button>`;
  items.appendChild(item);
  input.value = '';
  input.focus();
}
document.getElementById('clInput').addEventListener('keydown', function(e) {
  if (e.key === 'Enter') { e.preventDefault(); addClItem(); }
});

// â”€â”€ Form Submit Validation â”€â”€
function submitForm() {
  let valid = true;
  if (!selectedType) {
    document.getElementById('typeSelector').classList.add('error');
    document.getElementById('typeError').classList.add('show');
    valid = false;
  }
  const title = document.getElementById('newTitle');
  if (!title.value.trim()) {
    title.classList.add('error');
    document.getElementById('titleError').classList.add('show');
    valid = false;
  } else {
    title.classList.remove('error');
    document.getElementById('titleError').classList.remove('show');
  }
  if (valid) alert('âœ… ì—…ë¬´ ìƒì„± ì„±ê³µ!\níƒ€ì…: ' + selectedType + '\nì œëª©: ' + title.value);
}
document.getElementById('newTitle').addEventListener('input', function() {
  if (this.value.trim()) { this.classList.remove('error'); document.getElementById('titleError').classList.remove('show'); }
});
</script>
</body>
</html>
