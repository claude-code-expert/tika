# Feature Specification: 워크스페이스 설정 페이지

**Feature Branch**: `002-workspace-settings`
**Created**: 2026-02-25
**Status**: Draft
**Input**: User description: "@public/demo/settings.html 화면을 참고해서 관련 DB 및 화면, 기능 구현해"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 라벨 관리 (Priority: P1)

사용자는 설정 페이지에서 워크스페이스에 사용할 라벨을 생성, 수정, 삭제할 수 있다. 라벨은 이름과 색상으로 구성되며, 티켓에 분류 태그로 활용된다.

**Why this priority**: 라벨 CRUD API와 DB 테이블은 이미 구현되어 있어 UI 구현만 남아있다. 현재 라벨을 관리할 수 있는 전용 화면이 없으므로 가장 즉각적인 사용자 가치를 제공한다.

**Independent Test**: 설정 페이지의 "라벨 관리" 섹션에서 새 라벨을 생성하고, 수정하고, 삭제하는 전체 흐름을 완결적으로 테스트할 수 있다.

**Acceptance Scenarios**:

1. **Given** 라벨이 0개인 워크스페이스에서, **When** 이름과 색상을 입력하고 추가 버튼을 클릭하면, **Then** 라벨 목록에 새 라벨이 나타나고 총 개수가 업데이트된다.
2. **Given** 기존 라벨이 존재할 때, **When** 편집 버튼을 클릭하고 이름 또는 색상을 변경 후 저장하면, **Then** 목록에서 즉시 반영된다.
3. **Given** 기존 라벨이 존재할 때, **When** 삭제 버튼을 클릭하면, **Then** 확인 다이얼로그가 표시되고 확인 후 목록에서 제거된다.
4. **Given** 라벨이 이미 20개 존재할 때, **When** 추가를 시도하면, **Then** 최대 개수 초과 안내가 표시되고 추가가 거부된다.
5. **Given** 동일한 이름의 라벨이 이미 존재할 때, **When** 같은 이름으로 추가를 시도하면, **Then** 중복 이름 오류가 표시된다.

---

### User Story 2 - 알림 채널 설정 (Priority: P2)

사용자는 Slack Webhook URL 또는 Telegram Bot Token을 등록하여 티켓 마감일 D-1 알림을 받을 수 있다. 각 채널은 ON/OFF 토글로 활성화하며, 테스트 발송으로 설정을 검증할 수 있다.

**Why this priority**: 외부 알림 채널 연동은 사용자의 업무 관리 효율을 직접적으로 높이지만, 별도 DB 스키마 추가가 필요하므로 라벨 관리 다음 순위로 배치한다.

**Independent Test**: 알림 채널 섹션에서 Slack Webhook URL을 입력하고 토글을 ON으로 바꾼 뒤 테스트 발송으로 성공 여부를 확인할 수 있다.

**Acceptance Scenarios**:

1. **Given** Slack 채널이 비활성화 상태일 때, **When** 토글을 ON으로 바꾸고 저장하면, **Then** 채널이 활성화 상태로 저장된다.
2. **Given** 유효한 Slack Webhook URL이 입력되었을 때, **When** "테스트 발송" 버튼을 클릭하면, **Then** 해당 Slack 채널로 테스트 메시지가 발송되고 성공/실패 결과가 표시된다.
3. **Given** 알림 채널이 활성화 상태일 때, **When** 티켓의 마감일 하루 전이 되면, **Then** 등록된 채널로 티켓 제목과 마감일을 포함한 알림이 발송된다.
4. **Given** Webhook URL 없이 토글을 ON으로 바꾸고 저장을 시도하면, **When** 저장 버튼을 클릭하면, **Then** URL 입력 필요 안내가 표시된다.

---

### User Story 3 - 멤버 관리 (Priority: P3)

사용자는 워크스페이스 멤버 목록을 조회하고, 새 멤버를 초대하고, 역할을 변경하거나 제거할 수 있다. Phase 1에서는 실제 이메일 발송 없이 UI 수준에서 구현한다.

**Why this priority**: Phase 1은 단일 사용자 MVP이므로 멤버 관리의 실질적 필요도가 낮다. 목록 조회와 역할 표시만으로 충분한 가치를 제공한다.

**Independent Test**: 멤버 관리 섹션에서 현재 로그인 사용자의 정보가 표시되고, 멤버 초대 UI가 동작하는지 확인할 수 있다.

**Acceptance Scenarios**:

1. **Given** 로그인한 사용자가 멤버 관리 섹션을 열면, **When** 화면이 로드되면, **Then** 현재 워크스페이스 멤버 목록이 아바타, 이름, 이메일, 역할과 함께 표시된다.
2. **Given** 관리자 권한을 가진 사용자가, **When** 다른 멤버의 역할 변경 버튼을 클릭하면, **Then** 확인 다이얼로그 후 역할이 변경된다.
3. **Given** 워크스페이스에 관리자가 1명뿐일 때, **When** 그 관리자를 제거하거나 역할을 낮추려 하면, **Then** 작업이 거부되고 안내 메시지가 표시된다.

---

### User Story 4 - 일반 설정 (Priority: P4)

사용자는 워크스페이스 이름과 설명을 수정할 수 있다. 시간대, 언어, 날짜 형식 등 환경 설정도 UI로 표시된다 (Phase 1에서는 저장 기능 없이 조회만 구현).

**Why this priority**: 워크스페이스 이름 수정은 유용하지만 MVP 단계에서 즉시 필요한 기능은 아니다.

**Independent Test**: 워크스페이스 이름을 변경하고 저장하면 사이드바의 워크스페이스 이름이 업데이트된다.

**Acceptance Scenarios**:

1. **Given** 사용자가 일반 설정 섹션을 열면, **When** 현재 워크스페이스 이름이 표시되고 수정 후 저장하면, **Then** 이름이 즉시 업데이트된다.
2. **Given** 빈 문자열로 워크스페이스 이름 저장을 시도하면, **When** 저장 버튼을 클릭하면, **Then** 유효성 검사 오류가 표시되고 저장되지 않는다.

---

### Edge Cases

- 알림 채널 테스트 발송 중 네트워크 오류가 발생하면 실패 메시지를 표시하고 다시 시도할 수 있어야 한다.
- 라벨 삭제 시 해당 라벨이 적용된 티켓 수를 삭제 확인 다이얼로그에 표시한다.
- 설정 변경 사항을 저장하지 않고 다른 섹션으로 이동해도 경고 없이 이동한다 (저장은 명시적 버튼 클릭으로만 동작).
- 워크스페이스 알림 채널 설정은 워크스페이스별로 독립적으로 관리된다.

## Requirements *(mandatory)*

### Functional Requirements

**설정 페이지 공통**

- **FR-S01**: 설정 페이지는 헤더에 "설정" 타이틀과 좌측 네비게이션(일반 / 알림 채널 / 라벨 관리 / 멤버 관리)을 포함한다.
- **FR-S02**: 좌측 네비게이션 항목 클릭 시 해당 섹션 컨텐츠로 즉시 전환된다 (URL 변경 없는 탭 방식).
- **FR-S03**: 모든 저장/삭제 작업은 성공/실패 여부를 Toast 알림으로 3초간 표시한다.
- **FR-S04**: 메인 헤더의 설정 아이콘 클릭으로 설정 페이지로 이동하며, 로고 클릭으로 보드로 돌아온다.

**라벨 관리 (FR-L)**

- **FR-L01**: 워크스페이스 라벨 목록을 이름, 색상(hex), 사용 티켓 수와 함께 조회한다.
- **FR-L02**: 이름(1~20자)과 색상 팔레트 선택으로 라벨을 생성한다.
- **FR-L03**: 라벨 이름과 색상을 인라인 편집으로 수정하며, 미리보기를 실시간으로 표시한다.
- **FR-L04**: 라벨 삭제 전 확인 다이얼로그에서 영향받는 티켓 수를 표시한다.
- **FR-L05**: 워크스페이스당 최대 20개 라벨로 제한하며, 현재 개수를 헤더에 표시한다.
- **FR-L06**: 동일 워크스페이스 내 라벨 이름 중복을 허용하지 않는다.

**알림 채널 (FR-N)**

- **FR-N01**: Slack Incoming Webhook URL을 저장하고 ON/OFF 토글로 활성화를 제어한다.
- **FR-N02**: Telegram Bot Token과 Chat ID를 저장하고 ON/OFF 토글로 활성화를 제어한다.
- **FR-N03**: 테스트 발송 버튼 클릭 시 해당 채널로 테스트 메시지를 발송하고 결과(성공/실패)를 버튼 상태로 피드백한다.
- **FR-N04**: 알림 채널 설정을 워크스페이스별로 DB에 저장한다 (신규 테이블: notification_channels).
- **FR-N05**: 활성화된 채널로 티켓 마감일 D-1에 알림 메시지를 발송한다 (티켓 제목, 마감일 포함).

**멤버 관리 (FR-M)**

- **FR-M01**: 워크스페이스 멤버 목록을 아바타, 이름, 이메일, 역할(관리자/멤버), 가입일과 함께 조회한다.
- **FR-M02**: 이메일로 새 멤버를 초대할 수 있다 (Phase 1: UI만 구현, 실제 이메일 발송 미구현).
- **FR-M03**: 멤버 역할을 관리자/멤버 간 변경할 수 있다 (확인 다이얼로그 후 적용).
- **FR-M04**: 멤버를 워크스페이스에서 제거할 수 있다. 단, 마지막 관리자는 제거하거나 역할을 낮출 수 없다.

**일반 설정 (FR-G)**

- **FR-G01**: 현재 워크스페이스 이름(1~50자)과 설명(0~200자)을 수정하고 저장할 수 있다.
- **FR-G02**: 시간대, 언어, 날짜 형식, 주간 시작일을 선택 UI로 표시한다 (Phase 1: 저장 미구현).
- **FR-G03**: 위험 영역 섹션에서 데이터 초기화 및 워크스페이스 삭제 버튼을 제공한다 (Phase 1: UI 표시만, 실제 동작 미구현).

### Key Entities

- **Workspace**: 워크스페이스를 나타낸다. 기존 테이블에 `description(VARCHAR 200)` 컬럼 추가 필요.
- **NotificationChannel**: 워크스페이스별 알림 채널 설정을 나타낸다. 채널 타입(slack/telegram), 설정값(JSON), 활성화 여부를 저장하는 신규 테이블.
- **Label**: 워크스페이스에 속한 라벨. 기존 테이블 활용 (workspace_id, name, color).
- **Member**: 워크스페이스에 속한 사용자. 기존 테이블 활용 (user_id, workspace_id, role).

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자는 라벨 생성/수정/삭제 작업을 각각 30초 이내에 완료할 수 있다.
- **SC-002**: 알림 채널 테스트 발송 결과가 5초 이내에 화면에 표시된다.
- **SC-003**: 설정 페이지의 4개 섹션 간 전환이 즉각적으로 이루어진다 (화면 전환 대기 없음).
- **SC-004**: 라벨 생성/수정/삭제 후 보드 화면에서 즉시 반영된다 (페이지 새로고침 없음).
- **SC-005**: 모든 저장 작업은 성공/실패 여부를 3초 이내에 Toast로 사용자에게 알린다.

## Assumptions

- Phase 1에서 멤버 초대는 UI만 구현하며 실제 이메일 발송은 Phase 2에서 구현한다.
- 알림 D-1 스케줄러는 구현 방법을 스펙에서 명시하지 않는다 (서버사이드 구현 또는 외부 스케줄러 활용).
- 워크스페이스 환경 설정(시간대, 언어 등) 저장은 Phase 2에서 구현하며 Phase 1에서는 UI 표시만 한다.
- 위험 영역(초기화/삭제) 버튼은 Phase 1에서 UI만 표시하고 실제 동작은 구현하지 않는다.
- 설정 페이지 접근 권한은 로그인한 모든 사용자에게 허용한다 (Phase 1에서 역할별 접근 제어 없음).
- DB의 `workspaces` 테이블에 `description` 컬럼이 없으므로 마이그레이션이 필요하다.
